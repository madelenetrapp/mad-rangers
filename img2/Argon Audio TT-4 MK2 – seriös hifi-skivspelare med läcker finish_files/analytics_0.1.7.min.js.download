"use strict";!function(){var e=window,t=document,n=!1,o="",r="",i="https://t1.voyado.com/Collect";const a={PRODUCTVIEW:"productview",CART:"cart",CUSTOM:"custom"};function s(){if(arguments[0]&&c(arguments[0]))for(let e=0;e<arguments[0].length;e++)console.log("Event sent with payload "+JSON.stringify(arguments[0][e]))}function c(e){return"[object Array]"===Object.prototype.toString.call(Object(e))}function l(){try{let t=new Uint32Array(1);return e.crypto.getRandomValues(t),2147483647&t[0]}catch(e){return Math.round(2147483647*Math.random())}}function u(e,n,o){let r="";if(o){let e=new Date;e.setTime(e.getTime()+60*o*1e3),r="; expires="+e.toUTCString()}t.cookie=e+"="+n+r+"; path=/"}function f(e){const n=e+"=",o=t.cookie.split(";");for(let e=0;e<o.length;e++){let t=o[e];for(;" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(n))return t.substring(n.length,t.length)}return null}var d,g,m=void 0!==(g=e.VoyadoAnalyticsObject)&&-1<(g.constructor+"").indexOf("String")&&((d=e.VoyadoAnalyticsObject)?d.replace(/^[\s\xa0]+|[\s\xa0]+$/g,""):"")||"va";let h=function(e){const t=[];for(let n=1;n<e.length;n++)t.push(e[n]);return t};var p=function(){const t=e[m];t[arguments[0]].apply(t,h(arguments))};let y=function(t){const n=e[m];n[t[0]].apply(n,h(t))},v=function(e,t,n){t[e]=function(){try{return n.apply(this,arguments)}catch(e){throw e&&e.name,e}}};function S(e,t){let n={};if(r=n.t=a.CART,n.cr=e.cartRef||null,n.ci=e.contactId||null,w(n),n.l=e.locale||null,n.items=[],t&&t.length>0)for(let e=0;e<t.length;e++){let o={};o.i=t[e].itemId,o.q=t[e].quantity,n.items.push(o)}return n.carturl=e.cartUrl||null,n}function C(){return"VA"+(new Date).getUTCMilliseconds()+"."+l()}function w(n){n.ti=(new Date).toISOString(),function(e){e.te=o}(n),function(e){e.id=b.getValue();const t=O.getValue();e.s=t.id,e.ns=t.newSession,e.utm=t.utm,e.ere=t.externalReferrer}(n),function(e){e.ci&&"undefined"!==e.ci&&p.setContactId(e.ci);const t=V.getValue();t&&"undefined"!==t&&(e.ci=t)}(n),function(n){n.ua=e.navigator.userAgent,n.l=(n.l||e.navigator.language||e.navigator.browserLanguage||"").toLowerCase(),n.re=t.referrer,n.url=t.location.href}(n)}function I(){let t,n=/\+/g,o=/([^&=]+)=?([^&]*)/g,r=function(e){try{return decodeURIComponent(e.replace(n," "))}catch(t){return unescape(e)}},i=e.location.search.substring(1),a={};for(;t=o.exec(i);)try{a[r(t[1])]=r(t[2])}catch(e){console.error(`Unable to decode ${t[1]}=${t[2]}`,e)}return a}p.send=function(t,s){if(!n&&function(e){if(!o||o&&""===o)return console.error("Tenant is missing. Call va('setTenant','tenantid'); before any other call to va."),!1;if(!e)return console.error("Request is empty or unavailable."),!1;if(!e.id&&!e.ci)return console.error("Either contactId or id is required."),!1;if(e.ci&&e.ci.length>36)return console.error("contactId can not surpass 36 characters."),!1;if(![a.CART,a.PRODUCTVIEW,a.CUSTOM].includes(e.t))return console.error("Not a valid event type."),!1;if(e.t===a.PRODUCTVIEW){if(!e.i||e.i.length>255)return console.error("itemId is mandatory for productview and can not surpass 255 characters."),!1;if(e.ca&&e.ca.length>255)return console.error("categoryName can not surpass 255 characters."),!1}if(e.t===a.CART){if(e.items.length>0&&!e.l)return console.error("locale is mandatory for cart."),!1;for(let t=0;t<e.items.length;t++){if(!e.items[t].i||e.items[t].i.length>255)return console.error("itemId is mandatory for cart item and can not surpass 255 characters."),!1;if(!e.items[t].q||!Number.isInteger(e.items[t].q))return console.error("quantity is mandatory for cart item and must be an integer."),!1}}return!0}(t)){let n=e.XMLHttpRequest;if(!n)return!1;let a=new n;a.open("POST",i,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Send-Tenant",o),a.setRequestHeader("Send-Type",r.toLowerCase()),a.setRequestHeader("Script-Version","0.1.7"),a.onreadystatechange=function(){4===a.readyState&&(s(t),a=null)};const c=JSON.stringify(t);a.send(c);let l=O.getValue();l.newSession=!1,O.setValue(l)}return!0},p.setTenant=function(e){o=e},p.setEndpoint=function(e){i=e},p.setContactId=function(e){V.setValue(e)},p.setMode=function(e){n="test"===e.toLowerCase()},p.productview=function(e){let t={};r=t.t=a.PRODUCTVIEW,t.i=e.itemId,t.ca=e.categoryName||null,t.ci=e.contactId||null,t.l=e.locale||null,w(t),p.send(t,s)},p.cart=function(e){let t=S(e,e.items);p.send(t,s)},p.emptyCart=function(e){let t=S(e,[]);p.send(t,s)},p.custom=function(e,t){let n={};if(r=n.t=a.CUSTOM,e&&"string"==typeof e){if(n.ce=e,t){if("object"!=typeof t)return void console.error("eventData is invalid type.")}else t={};n.cd=t,n.ci=t.contactId||null,n.l=t.locale||null,w(n),p.send(n,s)}else console.error("eventName is missing or invalid type.")},p.activate=function(){const t=e[m];if(!t||!t.loaded){p.time=t&&t.time,p.loaded=!0;const n=e[m]=p;v("setTenant",n,n.setTenant),v("setEndpoint",n,n.setEndpoint),v("setContactId",n,n.setContactId),v("setMode",n,n.setMode),v("productview",n,n.productview),v("cart",n,n.cart),v("emptyCart",n,n.emptyCart),v("custom",n,n.custom),b.init(),V.init(),O.init()}const n=t&&t.q;if(c(n))for(let e=0;e<n.length;e++)y(n[e])};const O={sessionStorageKey:"_vaS",getValue:function(){const t=e.sessionStorage.getItem(O.sessionStorageKey);return t?JSON.parse(t):{}},setValue:function(t){const n=JSON.stringify(t);e.sessionStorage.setItem(O.sessionStorageKey,n)},init:function(){let n={};const o=()=>{const e=I(),t=Object.keys(e).filter(e=>e.toLowerCase().startsWith("utm"));n.utm=t.map(t=>({key:t.toLowerCase(),value:e[t]}))},r=t.referrer;!r||r&&r.startsWith(`${e.location.protocol}//${e.location.host}`)?((n=this.getValue()).id||(n.id=C()),void 0===n.newSession&&(n.newSession=!0),n.utm||o(),this.setValue(n)):r&&(n.id=C(),n.newSession=!0,n.externalReferrer=new URL(r).origin,o(),this.setValue(n))}},V={variableName:"vtid",urlParamKey:"vtid",localStorageKey:"vtid",cookieName:"_vaI",httpCookieName:"_vaI_server",getterOrder:["variable","urlparam","cookie","localstorage","httpcookie"],setterOrder:["variable","cookie","localstorage"],getters:{urlparam:()=>I()[V.urlParamKey],cookie:()=>f(V.cookieName),httpcookie:()=>f(V.httpCookieName),localstorage:()=>e.localStorage.getItem(V.localStorageKey),variable:()=>p[V.variableName]},setters:{cookie:e=>u(V.cookieName,e,525600),localstorage:t=>e.localStorage.setItem(V.localStorageKey,t),variable:e=>p[V.variableName]=e},getValue:function(){for(let e of this.getterOrder){const t=this.getters[e]();if(t&&"undefined"!==t)return t}},setValue:function(e){if(e&&"undefined"!==e)for(let t of this.setterOrder)this.setters[t](e)},init:function(){let e=null,t=null;for(t of this.getterOrder){const n=this.getters[t]();if(n&&"undefined"!==n){e=n;break}}if(e&&t)for(let n of this.setterOrder)n!==t&&this.setters[n](e)}},b={cookieName:"_va",getValue:function(){return f(this.cookieName)},setValue:function(e){u(this.cookieName,e,525600)},init:function(){let e=this.getValue();null===e&&(e=C()),this.setValue(e)}};p.activate()}(window);